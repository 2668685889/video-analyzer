# 数据格式化工具使用说明

## 概述

这个工具用于将杂乱的JSON格式视频分析数据整理成规范的输出格式。工具文件位于：`data_formatter.py`

## 功能特点

- 解析复杂的JSON数据结构
- 提取指定字段的文本内容
- 按照标准格式输出数据
- **支持单组数据和多组数据处理**
- 自动识别数据格式（对象或数组）
- 支持保存到文件
- 包含错误处理机制

## 输出格式

### 单组数据输出格式

```
视频序列号：[视频的唯一标识]
视频内容摘要：[视频内容的简要概述]
详细内容描述：[视频的详细描述信息]
关键词标签：[相关的关键词，用逗号分隔]
主要对象：[视频中的主要对象或主题]
```

### 多组数据输出格式

```
=== 第1组数据 ===
视频序列号：[第一个视频的标识]
视频内容摘要：[第一个视频的摘要]
详细内容描述：[第一个视频的详细描述]
关键词标签：[第一个视频的关键词]
主要对象：[第一个视频的主要对象]

=== 第2组数据 ===
视频序列号：[第二个视频的标识]
视频内容摘要：[第二个视频的摘要]
详细内容描述：[第二个视频的详细描述]
关键词标签：[第二个视频的关键词]
主要对象：[第二个视频的主要对象]

...
```

## 使用方法

### 1. 单组数据处理

```python
from data_formatter import format_data

# 单组数据（对象格式）
single_data = '{"视频序列号":[{"text":"20250824205845040F9095","type":"text"}],...}'

# 格式化数据
formatted_result = format_data(single_data)
print(formatted_result)
```

### 2. 多组数据处理

```python
from data_formatter import format_data

# 多组数据（数组格式）
multiple_data = '[{"视频序列号":[{"text":"VIDEO001","type":"text"}],...}, {"视频序列号":[{"text":"VIDEO002","type":"text"}],...}]'

# 格式化数据（自动识别为多组数据）
formatted_result = format_data(multiple_data)
print(formatted_result)
```

### 3. 保存到文件

```python
from data_formatter import format_data, save_formatted_data

# 格式化数据
formatted_result = format_data(json_data)

# 保存到文件
output_file = save_formatted_data(formatted_result, "my_output.txt")
print(f"数据已保存到: {output_file}")
```

### 4. 直接运行演示

```bash
python data_formatter.py
```

## 函数参数说明

### format_data(json_str)

**参数：**
- `json_str` (str): 包含视频分析数据的JSON字符串

**返回值：**
- `str`: 格式化后的字符串

**单组数据JSON格式：**
```json
{
  "视频序列号": [{"text": "20250824205845040F9095", "type": "text"}],
  "视频内容摘要": [{"text": "视频摘要内容", "type": "text"}],
  "详细内容描述": [{"text": "详细描述内容", "type": "text"}],
  "关键词标签": [{"text": "关键词1, 关键词2", "type": "text"}],
  "主要对象": [{"text": "主要对象描述", "type": "text"}]
}
```

**多组数据JSON格式：**
```json
[
  {
    "视频序列号": [{"text": "VIDEO001", "type": "text"}],
    "视频内容摘要": [{"text": "第一个视频摘要", "type": "text"}],
    "详细内容描述": [{"text": "第一个视频详细描述", "type": "text"}],
    "关键词标签": [{"text": "关键词1, 关键词2", "type": "text"}],
    "主要对象": [{"text": "第一个视频主要对象", "type": "text"}]
  },
  {
    "视频序列号": [{"text": "VIDEO002", "type": "text"}],
    "视频内容摘要": [{"text": "第二个视频摘要", "type": "text"}],
    "详细内容描述": [{"text": "第二个视频详细描述", "type": "text"}],
    "关键词标签": [{"text": "关键词3, 关键词4", "type": "text"}],
    "主要对象": [{"text": "第二个视频主要对象", "type": "text"}]
  }
]
```

### save_formatted_data(formatted_data, output_file=None)

**参数：**
- `formatted_data` (str): 格式化后的数据字符串
- `output_file` (str, optional): 输出文件路径，默认为 "formatted_output.txt"

**返回值：**
- `str`: 保存的文件路径，如果保存失败则返回 None

## 输出参数填写示例

根据您提供的杂乱数据，工具会输出以下格式：

```
视频序列号：20250824205845040F9095
视频内容摘要：一名男子解释了9月1日起生效的新社保规定，要求所有有雇佣关系的中小型企业为员工缴纳社保。他指出这将增加企业成本并可能引发劳动纠纷，因此推荐了一套包含七种法律协议的模板，以帮助企业规避用工风险。
详细内容描述：视频开始时，一名男子身穿黑色T恤，在深色背景前讲话。他提到从9月1日起，最高法明确规定所有存在雇佣关系的中小型企业，无论规模大小，都必须为员工缴纳社保。男子指出，这对劳动者是好事，但对中小企业而言，将带来无形中增加的成本（以河北地区为例，三人每月最低社保约4500元）。他警告说，现在的员工更懂法，若不缴纳社保，可能会被员工起诉追缴，导致大量劳动纠纷。为帮助企业规避这些风险，他推荐了一套由专业律师编写的法律协议模板。这些协议包括：
关键词标签：劳动法, 社保, 雇佣关系, 中小企业, 劳动纠纷, 法律风险, 合同模板, 劳动合同, 劳务合同, 录用条件确认书, 入职承诺书, 试用期合同, 职工宿舍免责协议书, 离职承诺书, 企业管理, 法律咨询, 成本控制, 中国法律, 招聘, 离职
主要对象：法律合同范本; 企业主 (针对中小企业)
```

## 错误处理

工具包含以下错误处理机制：

1. **JSON解析错误**：当输入的字符串不是有效的JSON格式时
2. **数据结构错误**：当JSON数据结构不符合预期时
3. **文件保存错误**：当无法写入输出文件时

## 注意事项

1. 输入的JSON字符串必须包含指定的字段名称（中文）
2. 每个字段应该是包含 `text` 和 `type` 属性的对象数组
3. 工具会自动处理多个文本片段，将它们合并为一个字符串
4. 输出文件默认使用UTF-8编码，确保中文字符正确显示
5. **数据格式识别**：
   - 单组数据：JSON对象格式 `{...}`
   - 多组数据：JSON数组格式 `[{...}, {...}, ...]`
6. **多组数据处理**：
   - 每组数据会自动编号（第1组数据、第2组数据...）
   - 各组数据之间用分隔线和空行分开
   - 支持任意数量的数据组

## 系统兼容性

- 支持 macOS、Windows、Linux 系统
- 需要 Python 3.6 或更高版本
- 无需额外依赖包，使用Python标准库