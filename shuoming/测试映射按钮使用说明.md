# 测试映射按钮使用说明

## 测试映射按钮位置

测试映射按钮位于映射配置界面的**底部按钮区域**，具体位置如下：

1. **打开映射配置界面**：
   - 运行命令：`python src/ui/mapping_config_ui.py`
   - 或者从主程序中打开映射配置功能

2. **按钮位置**：
   - 在配置编辑器的最底部
   - 位于右侧按钮组中
   - 按钮顺序从左到右：**保存配置** → **验证配置** → **测试映射** → **关闭**

## 界面布局说明

```
┌─────────────────────────────────────────────────────────────┐
│                    映射配置管理界面                          │
├─────────────────────────────────────────────────────────────┤
│  配置列表  │                配置编辑器                      │
│           │  ┌─────────────────────────────────────────┐   │
│  - 配置1   │  │  基本信息  │ AI字段 │ 飞书映射 │ 转换规则 │   │
│  - 配置2   │  └─────────────────────────────────────────┘   │
│  - 配置3   │                                              │
│           │              配置内容区域                      │
│           │                                              │
├─────────────────────────────────────────────────────────────┤
│                                    [保存配置][验证配置][测试映射][关闭] │
└─────────────────────────────────────────────────────────────┘
```

## 如何使用测试映射功能

### 前提条件

在使用测试映射功能之前，请确保已完成以下配置：

1. **AI字段配置**：
   - 至少添加一个AI字段
   - 设置字段名称、类型和描述

2. **飞书映射配置**：
   - 配置AI字段到飞书字段的映射关系
   - 确保映射关系正确

3. **转换规则配置**（可选）：
   - 如需要数据转换，配置相应的转换规则

### 使用步骤

1. **完成配置**：
   - 在各个标签页中完成必要的配置
   - 点击"保存配置"保存当前配置

2. **验证配置**（推荐）：
   - 点击"验证配置"按钮
   - 确保配置格式正确，无错误提示

3. **执行测试**：
   - 点击"测试映射"按钮
   - 系统会自动生成测试数据
   - 弹出测试结果窗口

### 测试结果解读

测试结果窗口会显示两部分内容：

1. **测试数据**：
   ```json
   {
     "video_title": "测试视频标题",
     "video_duration": 123,
     "video_tags": "测试视频标签"
   }
   ```

2. **映射结果**：
   ```json
   {
     "标题": "测试视频标题",
     "时长": 123,
     "标签": "测试视频标签"
   }
   ```

### 测试数据生成规则

系统根据AI字段配置自动生成测试数据：

- **文本字段**：生成"测试 + 字段描述"的文本
- **数字字段**：生成数字123
- **其他类型**：生成"测试数据"文本

### 常见问题排查

#### 问题1：找不到测试映射按钮

**可能原因**：
- 界面窗口太小，按钮被隐藏
- 界面加载不完整

**解决方法**：
- 调整窗口大小，确保底部按钮区域可见
- 重新启动映射配置界面
- 检查是否有错误提示

#### 问题2：点击测试映射按钮无反应

**可能原因**：
- 配置不完整（缺少AI字段或飞书映射）
- 配置格式错误
- 程序内部错误

**解决方法**：
- 先点击"验证配置"检查配置是否正确
- 确保至少有一个AI字段和对应的飞书映射
- 查看控制台是否有错误信息

#### 问题3：测试结果显示错误

**可能原因**：
- 转换规则配置错误
- 映射关系不正确
- 数据类型不匹配

**解决方法**：
- 检查转换规则的参数设置
- 验证AI字段名与转换规则中的字段名是否一致
- 检查飞书映射的字段名是否正确

## 测试映射的作用

测试映射功能主要用于：

1. **验证配置正确性**：确保映射关系和转换规则按预期工作
2. **预览数据格式**：查看最终同步到飞书的数据格式
3. **调试转换规则**：验证转换规则的执行效果
4. **配置优化**：根据测试结果调整和优化配置

## 注意事项

1. **测试数据非真实数据**：测试使用的是模拟数据，实际效果可能因真实数据格式而异

2. **保存配置后测试**：建议在保存配置后再进行测试，确保测试的是最新配置

3. **多次测试**：修改配置后应重新测试，确保更改生效

4. **实际验证**：测试通过后，建议使用真实数据进行最终验证

通过测试映射功能，您可以在实际使用前验证配置的正确性，避免在生产环境中出现数据格式错误。