# 飞书电子表格同步功能使用指南

## 概述

飞书电子表格同步功能是视频分析工具的重要组成部分，它允许您将视频分析结果自动同步到飞书电子表格中，方便团队协作和数据管理。

## 功能特性

### 核心功能
- **自动同步**: 分析完成后自动将结果同步到电子表格
- **手动同步**: 支持从历史记录中选择性同步
- **批量同步**: 支持一次性同步多条记录
- **状态监控**: 实时显示同步状态和进度
- **错误处理**: 完善的错误提示和重试机制

### 同步内容
电子表格将包含以下字段：
- 序列号
- 文件名
- 视频内容摘要
- 详细内容描述
- 关键词标签
- 主要角色/对象
- 分析时间
- 同步状态

## 配置步骤

### 1. 获取飞书应用凭证

1. 登录飞书开放平台 (https://open.feishu.cn/)
2. 创建企业自建应用
3. 获取以下信息：
   - App ID（应用ID）
   - App Secret（应用密钥）

### 2. 创建电子表格

1. 在飞书中创建新的电子表格
2. 记录电子表格的Token（从URL中获取）
3. 记录工作表ID（通常为第一个工作表）

### 3. 配置应用权限

在飞书开放平台中为应用添加以下权限：
- `spreadsheets:spreadsheet` - 查看、编辑电子表格
- `drive:drive` - 访问云文档

### 4. 在软件中配置

1. 打开软件设置界面
2. 切换到"飞书配置"选项卡
3. 填入以下信息：
   - 飞书应用ID
   - 飞书应用密钥
   - 电子表格Token
   - 工作表ID
4. 启用"电子表格同步"
5. 可选：启用"自动同步新的分析结果到电子表格"
6. 点击"保存设置"

## 使用方法

### 自动同步

1. 确保已正确配置飞书电子表格设置
2. 启用"自动同步新的分析结果到电子表格"选项
3. 进行视频分析
4. 分析完成后，结果将自动同步到电子表格

### 手动同步

#### 从历史记录同步

1. 点击"查看历史记录"按钮
2. 在历史记录窗口中选择要同步的记录
3. 点击"同步到电子表格"按钮
4. 等待同步完成

#### 批量同步

1. 在历史记录窗口中使用Ctrl/Cmd+点击选择多条记录
2. 或使用"全选"按钮选择所有记录
3. 点击"同步全部到电子表格"按钮
4. 确认同步操作
5. 查看同步进度和结果

### 状态监控

软件主界面底部状态栏会显示电子表格同步状态：
- **电子表格: 未配置** - 需要配置电子表格信息
- **电子表格: 已配置** - 配置正确，可以进行同步
- **电子表格: 连接失败** - 配置有误或网络问题
- **电子表格: 自动同步中...** - 正在进行自动同步
- **电子表格: 同步成功** - 同步操作成功完成
- **电子表格: 同步失败** - 同步操作失败
- **电子表格: 错误** - 发生未知错误

## 故障排除

### 常见问题

#### 1. 配置错误

**问题**: 状态显示"电子表格: 未配置"或"电子表格: 连接失败"

**解决方案**:
- 检查App ID和App Secret是否正确
- 确认电子表格Token格式正确
- 验证工作表ID是否存在
- 检查应用权限配置

#### 2. 同步失败

**问题**: 同步过程中出现错误

**解决方案**:
- 检查网络连接
- 确认飞书应用状态正常
- 验证电子表格是否被删除或权限变更
- 查看详细错误信息

#### 3. 数据不完整

**问题**: 电子表格中的数据缺失或格式错误

**解决方案**:
- 确保视频分析结果完整
- 检查字段映射配置
- 重新同步相关记录

### 调试步骤

1. **检查配置**
   - 在设置界面验证所有配置项
   - 使用"测试连接"功能（如果可用）

2. **查看日志**
   - 检查软件运行日志
   - 查看同步过程中的错误信息

3. **手动测试**
   - 尝试手动同步单条记录
   - 观察同步过程和结果

4. **网络检查**
   - 确认可以访问飞书API
   - 检查防火墙和代理设置

## 最佳实践

### 1. 数据管理
- 定期备份电子表格数据
- 避免手动修改同步生成的数据
- 使用筛选和排序功能管理大量数据

### 2. 权限管理
- 合理设置电子表格的共享权限
- 定期检查应用权限状态
- 避免在生产环境中使用测试应用

### 3. 性能优化
- 避免频繁的大批量同步操作
- 在网络状况良好时进行同步
- 监控同步性能和成功率

## 技术说明

### 同步机制
- 使用飞书开放API进行数据同步
- 支持增量同步，避免重复数据
- 自动处理行号分配和数据更新

### 数据格式
- 所有文本数据使用UTF-8编码
- 时间格式：YYYY-MM-DD HH:MM:SS
- 支持多行文本和特殊字符

### 安全性
- 应用凭证本地加密存储
- 使用HTTPS协议传输数据
- 支持访问令牌自动刷新

## 更新日志

### v1.0.0
- 初始版本发布
- 支持基本的电子表格同步功能
- 实现自动和手动同步
- 添加状态监控和错误处理

---

如有其他问题，请参考软件的其他文档或联系技术支持。