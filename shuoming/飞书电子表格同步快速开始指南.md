# 飞书电子表格同步快速开始指南

## 5分钟快速配置

### 步骤1: 准备飞书应用

1. **创建飞书应用**
   - 访问 [飞书开放平台](https://open.feishu.cn/)
   - 点击"创建企业自建应用"
   - 填写应用名称和描述
   - 记录 `App ID` 和 `App Secret`

2. **配置应用权限**
   - 进入应用管理页面
   - 点击"权限管理"
   - 添加以下权限：
     - `spreadsheets:spreadsheet` (查看、编辑电子表格)
     - `drive:drive` (访问云文档)
   - 点击"发布版本"

### 步骤2: 创建电子表格

1. **新建电子表格**
   - 在飞书中创建新的电子表格
   - 给电子表格命名（如："视频分析结果"）

2. **获取表格信息**
   - 从浏览器地址栏复制电子表格URL
   - URL格式：`https://xxx.feishu.cn/sheets/shtxxxxxxxxxxxxx`
   - 提取Token：`shtxxxxxxxxxxxxx`（去掉前缀的部分）
   - 工作表ID通常为：`Sheet1` 或类似名称

### 步骤3: 软件配置

1. **打开设置**
   - 启动视频分析软件
   - 点击"设置"按钮
   - 切换到"飞书配置"选项卡

2. **填写配置信息**
   ```
   飞书应用ID: cli_xxxxxxxxxx
   飞书应用密钥: xxxxxxxxxxxxxxxxxxxx
   电子表格Token: shtxxxxxxxxxxxxx
   工作表ID: Sheet1
   ```

3. **启用功能**
   - ✅ 启用电子表格同步
   - ✅ 自动同步新的分析结果到电子表格
   - 点击"保存设置"

### 步骤4: 测试同步

1. **检查状态**
   - 查看主界面底部状态栏
   - 应显示："电子表格: 已配置"

2. **进行测试**
   - 选择一个视频文件
   - 进行分析
   - 分析完成后检查飞书电子表格
   - 确认数据已正确同步

## 常见配置问题

### 问题1: "电子表格: 连接失败"

**可能原因**:
- App ID或App Secret错误
- 电子表格Token格式不正确
- 应用权限未正确配置

**解决方法**:
1. 重新检查App ID和App Secret
2. 确认电子表格Token格式：`shtxxxxxxxxxxxxx`
3. 在飞书开放平台检查应用权限
4. 确保应用已发布版本

### 问题2: "电子表格: 未配置"

**解决方法**:
1. 检查所有配置项是否已填写
2. 确认"启用电子表格同步"已勾选
3. 点击"保存设置"按钮

### 问题3: 同步后电子表格为空

**可能原因**:
- 工作表ID错误
- 电子表格权限不足
- 数据格式问题

**解决方法**:
1. 检查工作表ID是否正确
2. 确认应用有电子表格编辑权限
3. 尝试手动同步单条记录

## 电子表格结构说明

同步后的电子表格将包含以下列：

| 列 | 字段名 | 说明 |
|----|--------|------|
| A | 序列号 | 唯一标识符 |
| B | 文件名 | 视频文件名称 |
| C | 视频内容摘要 | AI生成的内容摘要 |
| D | 详细内容描述 | 详细的内容描述 |
| E | 关键词标签 | 提取的关键词 |
| F | 主要角色/对象 | 识别的角色或对象 |
| G | 分析时间 | 分析完成时间 |
| H | 同步状态 | 同步状态标识 |

## 使用技巧

### 1. 批量同步历史数据

如果您有大量历史分析数据需要同步：

1. 点击"查看历史记录"
2. 使用"全选"按钮选择所有记录
3. 点击"同步全部到电子表格"
4. 等待批量同步完成

### 2. 选择性同步

如果只需要同步特定记录：

1. 在历史记录中按住Ctrl/Cmd键
2. 点击选择需要同步的记录
3. 点击"同步到电子表格"

### 3. 监控同步状态

- 主界面底部状态栏实时显示同步状态
- 绿色表示成功，红色表示失败
- 详细错误信息会在弹窗中显示

### 4. 自动同步设置

建议配置：
- ✅ 启用"自动同步新的分析结果到电子表格"
- 这样每次分析完成后会自动同步到电子表格
- 无需手动操作，提高工作效率

## 权限配置详解

### 飞书开放平台权限设置

1. **进入权限管理**
   - 登录飞书开放平台
   - 选择您的应用
   - 点击"权限管理"

2. **添加必需权限**
   ```
   权限范围: 云文档
   权限名称: spreadsheets:spreadsheet
   权限描述: 查看、编辑电子表格
   
   权限范围: 云文档
   权限名称: drive:drive  
   权限描述: 访问云文档
   ```

3. **发布应用版本**
   - 添加权限后必须发布新版本
   - 点击"创建版本"
   - 填写版本说明
   - 点击"发布"

### 电子表格共享设置

1. **设置共享权限**
   - 打开电子表格
   - 点击右上角"共享"按钮
   - 添加应用或设置为"组织内可编辑"

2. **权限级别说明**
   - **可编辑**: 推荐设置，允许同步写入数据
   - **可查看**: 仅能读取，无法同步数据
   - **可评论**: 不适用于API操作

## 故障排除清单

### 配置检查清单

- [ ] App ID格式正确（cli_开头）
- [ ] App Secret已正确复制
- [ ] 电子表格Token格式正确（sht开头）
- [ ] 工作表ID存在且正确
- [ ] 应用权限已添加并发布
- [ ] 电子表格共享权限正确
- [ ] 网络连接正常

### 测试步骤

1. **基础连接测试**
   - 保存配置后检查状态显示
   - 应显示"电子表格: 已配置"

2. **单条记录测试**
   - 分析一个小视频文件
   - 观察自动同步过程
   - 检查电子表格中的数据

3. **手动同步测试**
   - 从历史记录选择一条记录
   - 手动同步到电子表格
   - 验证同步结果

## 下一步

配置完成后，您可以：

1. **开始使用**: 正常进行视频分析，结果会自动同步
2. **查看文档**: 阅读完整的使用指南了解更多功能
3. **优化设置**: 根据使用情况调整配置
4. **团队协作**: 与团队成员共享电子表格进行协作

---

如果遇到问题，请参考详细的故障排除文档或联系技术支持。